============
boiler_plate
============

An empty skeleton to show the template of a Land Registry Flask application.


Platform
========

Windows 7
---------

1. Install Mingw (Git Bash)

2. Install `Python 3.4 <https://www.python.org/ftp/python/3.4.0/python-3.4.0.amd64.msi>`_::

    $ export PATH=/c/Python34/:$PATH

3. Get Pip::

    $ curl -O https://bootstrap.pypa.io/get-pip.py
    $ export PATH=/c/Python34/Scripts/:$PATH

CentOS 7
--------

1. Install Python 3::

   $ sudo yum install python34

2. Install Pip::

   $ wget https://bootstrap.pypa.io/get-pip.py
   $ sudo python3.4 get-pip.py

4. Use a Virtualenv::

   $ pyvenv-3.4  venv
   $ . venv/bin/activate


Quickstart
==========

An example of how to use boiler_plate as a cookie cutter for your 
new Land Registry Flask application. 


1. Clone::

    $ git clone git@git.lr.net:casework/boiler_plate.git

2. Rename the directory::
  
    $ mv boiler_plate my_project

3. Watermark::

    $ cd my_project
    $ git rev-parse HEAD > boiler_plate_HEAD.txt

5. Remove old repo::

    $ rm -rf .git

6. Rename::

    $ find . -type f -print0 | xargs -0 sed -i '' -e 's/boiler_plate/my_project/g'
    $ mv boiler_plate my_project

7. Create new repo::

   $ git init

8. Install the prereqs::

    $ pip3 install -r requirements.txt

9. Run the unittests::

    $ python setup.py test

10. Build the docs::

    $ sphinx-apidoc -F -o docs my_project
    $ python setup.py build_sphinx
    $ firefox build/sphinx/html/index.html 

11. Start Developer Mode::

    $ python setup.py develop --user
    $ cd ~
    $ python 

    >>> import my_project
    >>> my_project.__version__

    $ cd -

12. Check the application::

    $ ./run.sh &
    $ curl http://127.0.0.1:5000/
    $ curl http://127.0.0.1:5000/helloworld/
    $ fg


Installation
============

Installation via setup.py::

    $ python setup.py install

Or with `pip <https://pip.pypa.io/en/stable/reference/pip_install/>`_.


Running
=======

::

    $ boiler_plate --version
    boiler_plate 0.1.1

::

    $ boiler_plate --help
    Usage: boiler_plate [options]

    Options:
      --version             show program's version number and exit
      -h, --help            show this help message and exit
      -d, --debug           Run Flask in debug
      -p PORT, --port=PORT  Set the port
      --host=HOST           The host IP.


Gunicorn Integration
====================

Install as a package to the system::

    $ python setup.py sdist
    $ sudo pip3 install dist/boiler_plate-0.1.tar.gz
    $ python -c "import boiler_plate; print(boiler_plate.__file__)"
    /usr/local/lib/python3.4/dist-packages/boiler_plate/__init__.py
    $ gunicorn --bind 0.0.0.0:8000 boiler_plate:app
    [2016-01-21 12:02:48 +0000] [21948] [INFO] Starting gunicorn 19.4.5

Uninstall the system package::

    $ sudo pip3 uninstall boiler_plate
    Uninstalling boiler-plate:
    <snip>
    Successfully uninstalled boiler-plate
    $ python -c "import boiler_plate; print(boiler_plate.__file__)"
    Traceback (most recent call last):
    File "<string>", line 1, in <module>
    ImportError: No module named 'boiler_plate'

Install in Developer Mode::

    $ cd /home/tom/projects/boiler_plate/
    $ sudo pip3 install -e .
    $ python -c "import boiler_plate; print(boiler_plate.__file__)"
    /home/fred/projects/boiler_plate/boiler_plate/__init__.py
    $ gunicorn --bind 0.0.0.0:8000 boiler_plate:app
    [2016-01-21 12:05:02 +0000] [21997] [INFO] Starting gunicorn 19.4.5


Credits
=======

1. `dm-api-skeleton <https://github.com/LandRegistry/dm-api-skeleton>`_.

2. `digital ocean <https://www.digitalocean.com/community/tutorials/how-to-package-and-distribute-python-applications>`_.

3. `hitchhiker's guide <https://the-hitchhikers-guide-to-packaging.readthedocs.org/en/latest/>`_.


Pre-Reqs
========

* The setup.py takes the enhanced approach provided by `setuptools <https://pythonhosted.org/setuptools/setuptools.html>`_.

* Documentation is via `sphinx <http://www.sphinx-doc.org/en/stable/>`_.


Blueprints
==========

`helloworld` shows an example of a `Flask Blueprint <http://flask.pocoo.org/docs/0.10/blueprints/>`_.


Tests
=====

The skeleton has a harvester which creates a test suite that can 
be run from the setup script. 

::

    $ python setup.py test


Versioning
==========

Increment the  `__version__` variable in the project level __init__.py 


Documentation
=============

The API Docs are a modified from those auto-generated by apidoc.

Rerun this command to fill in the missing rst files.

::

    $ sphinx-apidoc -F -o docs boiler_plate

Build the html from the rst.

::
 
    $ python setup.py build_sphinx


Known Issues
============

* Test coverage in the pytest runner.
* Sphinx docs are klunky
* License 
* File Headers
